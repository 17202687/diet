<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>이벤트 리스너로 장바구니 수량 변경 및 자동 합계 구하기</title>
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
	<link rel="stylesheet" href="../../static/CSS/10-11.css" />
	<script type="text/javascript" src="../../static/javascript/10-11.js">
        function formsubmit(){

        }
    </script>  
</head>
<body>

    <form name="orderform" id="orderform" method="post" class="orderform">
        {% csrf_token %}
            <input type="hidden" name="cmd" value="order">
            <div class="basketdiv" id="basket">
                <div class="row head">
                    <div class="subdiv">
                        <div class="check">선택</div>
                        <div class="pname">음식명</div>
                    </div>
                    <div class="subdiv">
                        <div class="basketprice">kcal</div>
                        <div class="num">수량</div>
                        <div class="sum">합계</div>
                    </div>
                    <div class="subdiv">
    
                        <div class="basketcmd">삭제</div>
                    </div>
                    <div class="split"></div>
                </div>
        
                {% for food in foods %}
                <div class="row data">
                    <div class="subdiv">
                        <div class="check"><input type="checkbox" name="buy" value=260 onclick="javascript:basket.checkItem();">&nbsp;</div>
                        <div class="pname" id="food_name{{forloop.counter}}">{{food.food_name}}</div>
                    </div>
                    <div class="subdiv">
                        <div class="basketprice"><input type="hidden" name="p_price" id="p_price{{forloop.counter}}" class="p_price" value="{{food.food_kcal}}">{{food.food_kcal}}kcal</div>
                        <div class="num">
                            <div class="updown">
                                <span onclick="javascript:basket.changePNum('{{forloop.counter}}');"><i class="fas fa-arrow-alt-circle-up up"></i></span>
                                <input type="text" name="p_num{{forloop.counter}}" id="p_num{{forloop.counter}}" size="2" maxlength="5" class="p_num" value="{{food.food_cnt}}" onkeyup="javascript:basket.changePNum('{{forloop.counter}}');">
                                <span onclick="javascript:basket.changePNum('{{forloop.counter}}');"><i class="fas fa-arrow-alt-circle-down down"></i></span>
                            </div>
                        </div>
                        <div class="sum">{{food.food_kcal}}kcal</div>
                    </div>
                    <div class="subdiv">
                        <div class="basketcmd"><a href="javascript:void(0)" class="abutton" onclick="javascript:basket.delItem();">삭제</a></div>
                    </div>
                </div>
                {% endfor %}
                <input id=foodname type="text" siz="1" style="visibility: hidden;" name="food_name">
                <input id=foodcnt type="text" siz="1" style="visibility: hidden;" name="foodcnt">
            </div>
            <script>
                var sum=document.getElementsByClassName("sum");
                var i=0;
                "{% for kc in kcal %}"
                sum.item(i).innerHTML='{{kc}}'+"kcal"
                i+=1;
                sum.item(0).innerHTML="합계";
                "{% endfor %}"
            </script>
            <div class="right-align basketrowcmd">
                <a href="javascript:void(0)" class="abutton" onclick="javascript:basket.delCheckedItem();">선택음식삭제</a>
                <a href="javascript:void(0)" class="abutton" onclick="javascript:basket.delAllItem();">비우기</a>
            </div>
    
            <div class="bigtext right-align sumcount" id="sum_p_num">음식갯수: {{cnt}}개</div>
            <div class="bigtext right-align box blue summoney" id="sum_p_price">합계kcal: {{sum}}kcal</div>
            
            <script>
                function names(){
                    var a=document.getElementById("foodname");
                    var b=document.getElementsByClassName("pname");
                    var c=new Array();
                    var d=document.getElementsByClassName("p_num");
                    var e=new Array();
                    var f=document.getElementById("foodcnt");
                    for(var i=0;i<b.length;++i){
                        c[i-1]=b.item(i).innerHTML;
                    }
                    a.value=c;
                    for(var i=0;i<d.length;++i){
                        e[i]=d.item(i).value;
                    }
                    f.value=e;
                }
            </script>
            <div class="right-align basketrowcmd">
                <a href="javascript:void(0)" class="search" onclick="names()">검색</a>
                <a href="javascript:void(0)" type="submit" class="save" >저장</a>
                <button type="submit" onclick="names()">저장</button>
            </div>
        </form>

</body>
</html>
